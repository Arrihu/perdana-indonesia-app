language: python
python: 
    - '3.7'
git:
    depth: false
services:
    - postgresql
env:
    - DATABASE_URL=postgres://postgres@localhost:5432/perdana_db
before_install:
    - pip install --upgrade pip && python -m pip install pipenv
install:
    - pipenv install --system
before_script:
    - psql -c 'create database perdana_db' -U postgres
script: python manage.py test --settings=config.prod_settings
deploy:
    provider: heroku
    api_key:
        secure: 0giSMeSwpSljzbk/GqDOdJFZNNhop5Z2J99xeLC4HwnnFtzQoo3cn4AUqHJHojXxp8Y7LMgGR8wNAeZRmOuzdXV2HV0byFT0bQIKyDwR+2o6eAt3WPL8m/j51SsMha19vRJch5gXMG+a3CvihV+5ngC28iBJFpWjoZUJr6NMJ4n4PoHaw+jUcbKlrpcIaRW2ZlpLFZUABdBbBxDAgDx44/H+VrlpuZq20gngELINy/3PQHNiymZGRxqbjGTu4vdbyMHg7hozyZ0y9TGFK9nPmEMILncYQWo1hMQ/E/mrW3uUChoMZnzqQIZBzpnypoC0NjxYg9FlAMp2mQmYKmZDOfIEOefMBWJLIDVLcklMDrYydZstvBAgWxBiMILDGsET+d0+7VZJsf68MR/wKTRtr4Az4gyJBhWQv1oUThjptL2Z37mx8KNDeQSFjg2D25J49RPgqbyYEA5be6nFH35nyKXUgHmOahDqhe6MDtq79U/TlhDFmY5v3D1hzqNxmwpaIu9M8oysp2kVBzyXGw1CJAkS5Nz+F+huyHsmyez8ABX5J2XQFAg0rrbIvw1BNsbnrR2gGlfUzp7B4+MvZrdwnB76FG9SJw7nde4GWg34IZGe5u9/Kkw+yfeee9Yqd1oPM6rSbCwR5tEKSekZ3CNE3dMylNNWAmqil5tGdJepens=
    app: perdana-indonesia-app
    on:
        repo: perdana-ntb/perdana-indonesia-app
        branch: staging
